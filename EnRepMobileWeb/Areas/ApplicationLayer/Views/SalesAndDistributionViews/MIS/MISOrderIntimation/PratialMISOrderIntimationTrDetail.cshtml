@using System.Data;
<tr>
    <td style="padding-left:10px;">
        <table class="main_header">
            <tr>
                <td>
                    @if (ViewBag.Details.Rows != null)
                    {
                        DataView data = new DataView();
                        foreach (DataRow dr in ViewBag.Details.Rows)
                        {
                            string itemPath = Server.MapPath("~") + "..\\Attachment\\ItemSetup\\";
                            string itemPath1 = itemPath + @dr["item_img_name"].ToString().Replace("/", "\\'");
                            var ItemImage = itemPath1.Replace("~\\", "").Replace("\\\\", "\\").Replace("'", "");
                            <div class="bor">
                                <div class="bor">
                                    <table class="fontsize" width="96%" style="border: 1px solid #000000; overflow:hidden;">
                                        <tr>
                                            <td colspan="3">
                                                <table width="100%">
                                                    <tr>
                                                        @*<td height="100" style="text-align:center;">
                            <img src="@ItemImage" />
                        </td>*@

                                                        <td height="150" style="text-align:center;">
                                                            <img src="@ItemImage" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowItemName"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l">Item Name</td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">
                                                            @dr["item_name"].ToString()
                                                            <br />@dr["sub_item_ord_qty"].ToString()                                                    @*<table class="fontsize">
                                <tr>
                                    <td valign="top"></td>
                                </tr>
                            </table>*@
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowCustSpecItemDesc"].ToString() == "Y")//add by shubham Maurya on 18-09-2025
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l">Customer Specific</td>
                                                        <td width="3%" valign="top">:</td>
                                                        <td width="62%" valign="top" height="30">
                                                            @dr["custWiseItemDes"].ToString()
                                                        </td>
                                                    </tr>
                                                }
                                            }

                                        }
                                        else
                                        {
                                            <tr>
                                                <td width="35%" valign="top" class="pa_l">Item Name</td>
                                                <td width="3%">:</td>
                                                <td width="62%">
                                                    @dr["item_name"].ToString()
                                                    <br />@dr["sub_item_ord_qty"].ToString()                                                    @*<table class="fontsize">
                        <tr>
                            <td valign="top"></td>
                        </tr>
                    </table>*@
                                                </td>
                                            </tr>
                                        }
                                        @if (ViewBag.DocumentMenuId != "105103190125")
                                        {
                                            <tr>
                                                <td width="35%" class="pa_l">HSN/SAC</td>
                                                <td width="3%">:</td>
                                                <td width="62%">@dr["hsn_code"].ToString()</td>
                                            </tr>
                                        }

                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowUOM"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" class="pa_l">UOM</td>
                                                        <td width="3%">:</td>
                                                        <td width="62%"> @dr["uom_alias"].ToString()</td>
                                                    </tr>
                                                }
                                            }


                                        }
                                        else
                                        {
                                            <tr>
                                                <td width="35%" class="pa_l">UOM</td>
                                                <td width="3%">:</td>
                                                <td width="62%"> @dr["uom_alias"].ToString()</td>
                                            </tr>
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowHSN"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>HSN </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["HSN_code"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowRefrenceNumber"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>Reference No. : </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["ref_doc_no"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowOEMNo"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>OEM No. : </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["item_oem_no"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowTechSpec"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>Tech Specification </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["item_tech_spec"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowTechDesc"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>Tech Description </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["item_tech_des"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowWeight"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" valign="top" class="pa_l"> <div>Weight (In Kg) </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%"> @dr["wght_kg"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            <tr>
                                                <td width="35%" valign="top" class="pa_l"> <div>Order Number </div></td>
                                                <td width="3%">:</td>
                                                <td width="62%"> @dr["so_no"].ToString()</td>
                                            </tr>
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            <tr>
                                                <td width="35%" valign="top" class="pa_l"> <div>Order Date </div></td>
                                                <td width="3%">:</td>
                                                <td width="62%"> @dr["so_dt"].ToString()</td>
                                            </tr>
                                        }
                                        @*<tr>
            <td width="35%" valign="top" class="pa_l"> <div>Tech Description :</div></td>
            <td>@dr["item_tech_des"].ToString()</td>
        </tr>
        <tr>
            <td width="35%" class="pa_l">Reference No. :</td>
            <td>@dr["RefereanceNo"].ToString()</td>
        </tr>*@
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowOrderedQuantity"].ToString() == "Y")
                            {
                                    <tr>
                                        <td width="35%" class="pa_l">Order Quantity</td>
                                        <td width="3%">:</td>
                                        <td width="62%">@dr["OrderQty"].ToString()</td>
                                    </tr>
                            }
                        }
                                        }
                                            
                                        <tr>
                                            <td width="35%" class="pa_l_pendqty"><strong>Pending Quantity</strong></td>
                                            <td width="3%">:</td>
                                            <td width="62%" class="pa_l_pendqty">@dr["PendingQty"].ToString()</td>
                                        </tr>

                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowPrice"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" class="pa_l"> <div>Price </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["currLogo"].ToString() @dr["price"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowPendingAmt"].ToString() == "Y")//add by shubham Maurya on 18-09-2025
                                                {
                                                    <tr>
                                                        <td width="35%" class="pa_l"> <div>Pending Amount </div></td>
                                                        <td width="3%">:</td>
                                                        <td width="62%">@dr["currLogo"].ToString() @dr["PendingAmount"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId != "105103190125")
                                        {
                                            <tr>
                                                <td width="35%" valign="top" class="pa_l"> <div>Tech Specification </div></td>
                                                <td width="3%">:</td>
                                                <td width="62%">@dr["item_tech_spec"].ToString()</td>
                                            </tr>
                                        }
                                        @if (ViewBag.DocumentMenuId != "105103190125")
                                        {
                                            <tr>
                                                <td width="35%" valign="top" class="pa_l"> <div>Weight (In Kg) </div></td>
                                                <td width="3%">:</td>
                                                <td width="62%"> @dr["wght_kg"].ToString()</td>
                                            </tr>
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowCustName"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" class="pa_l">Customer Name</td>
                                                        <td width="3%">:</td>
                                                        <td width="62%"> @dr["cust_name"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")//add by shubham Maurya on 18-09-2025
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowBomAvl"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td width="35%" class="pa_l">BOM Available</td>
                                                        <td width="3%">:</td>
                                                        <td width="62%"> @dr["HasBOM"].ToString()</td>
                                                    </tr>
                                                }
                                            }
                                        }
                                        @if (ViewBag.DocumentMenuId == "105103190125")
                                        {
                                            if (ViewBag.PrintOption != null)
                                            {
                                                if (ViewBag.PrintOption.Rows[0]["ShowRemarks"].ToString() == "Y")
                                                {
                                                    <tr>
                                                        <td valign="top" colspan="3" class="pa_l" height="100">
                                                            Remarks<br /> @dr["it_remarks"].ToString()
                                                        </td>

                                                        @*<td height="150" style="text-align:center;"> <img src="@ItemImage" style="width:100px; height:100%; object-fit:contain;" /></td>*@
                                                    </tr>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <tr>
                                                <td valign="top" colspan="3" class="pa_l" height="100">
                                                    Remarks<br /> @dr["it_remarks"].ToString()
                                                </td>

                                                @*<td height="150" style="text-align:center;"> <img src="@ItemImage" style="width:100px; height:100%; object-fit:contain;" /></td>*@
                                            </tr>
                                        }
                                    </table>
                                </div>
                            </div>
                        }
                    }
                </td>
            </tr>
        </table>
    </td>
</tr>
